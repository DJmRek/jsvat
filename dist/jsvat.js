!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.jsvat=e():r.jsvat=e()}(this,function(){return function(r){var e={};function t(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=r,t.c=e,t.d=function(r,e,n){t.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:n})},t.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,e){if(1&e&&(r=t(r)),8&e)return r;if(4&e&&"object"==typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&e&&"string"!=typeof r)for(var i in r)t.d(n,i,function(e){return r[e]}.bind(null,i));return n},t.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(e,"a",e),e},t.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},t.p="",t(t.s=0)}([function(r,e,t){"use strict";t.r(e);var n={name:"Austria",codes:["AT","AUT","040"],calcFn:function(r){for(var e,t=0,n=0;n<7;n++)t+=(e=r.charAt(n)*this.rules.multipliers[n])>9?Math.floor(e/10)+e%10:e;return 10===(t=10-(t+4)%10)&&(t=0),t===+r.slice(7,8)},rules:{multipliers:[1,2,1,2,1,2,1],regex:[/^(AT)U(\d{8})$/]}},i={name:"Cyprus",codes:["CY","CYP","196"],calcFn:function(r){var e=0;if(12==+r.slice(0,2))return!1;for(var t=0;t<8;t++){var n=+r.charAt(t);if(t%2==0)switch(n){case 0:n=1;break;case 1:n=0;break;case 2:n=5;break;case 3:n=7;break;case 4:n=9;break;default:n=2*n+3}e+=n}return e%=26,(e=String.fromCharCode(e+65))===r.substr(8,1)},rules:{regex:[/^(CY)([0-59]\d{7}[A-Z])$/]}},l={name:"Ireland",codes:["IE","IRL","372"],calcFn:function(r){var e=0;this.rules.typeFormats.first.test(r)&&(r="0"+r.substring(2,7)+r.substring(0,1)+r.substring(7,8));for(var t=0;t<7;t++)e+=+r.charAt(t)*this.rules.multipliers[t];return this.rules.typeFormats.third.test(r)&&("H"===r.charAt(8)?e+=72:e+=9),(e=0===(e%=23)?"W":String.fromCharCode(e+64))===r.slice(7,8)},rules:{multipliers:[8,7,6,5,4,3,2],typeFormats:{first:/^\d[A-Z*+]/,third:/^\d{7}[A-Z][AH]$/},regex:[/^(IE)(\d{7}[A-W])$/,/^(IE)([7-9][A-Z*+)]\d{5}[A-W])$/,/^(IE)(\d{7}[A-W][AH])$/]}},s={name:"Italy",codes:["IT","ITA","380"],calcFn:function(r){var e,t=0;if(0==+r.slice(0,7))return!1;if((e=+r.slice(7,10))<1||e>201&&999!==e&&888!==e)return!1;for(var n=0;n<10;n++)t+=(e=+r.charAt(n)*this.rules.multipliers[n])>9?Math.floor(e/10)+e%10:e;return(t=10-t%10)>9&&(t=0),t===+r.slice(10,11)},rules:{multipliers:[1,2,1,2,1,2,1,2,1,2],regex:[/^(IT)(\d{11})$/]}},u={name:"Spain",codes:["ES","ESP","724"],calcFn:function(r){var e,t,n=0,i=0;if(this.rules.additional[0].test(r)){for(n=0;n<7;n++)i+=(e=r.charAt(n+1)*this.rules.multipliers[n])>9?Math.floor(e/10)+e%10:e;return 10===(i=10-i%10)&&(i=0),i===(t=+r.slice(8,9))}if(this.rules.additional[1].test(r)){for(n=0;n<7;n++)i+=(e=r.charAt(n+1)*this.rules.multipliers[n])>9?Math.floor(e/10)+e%10:e;return i=10-i%10,(i=String.fromCharCode(i+64))===(t=r.slice(8,9))}if(this.rules.additional[2].test(r)){var l=r;return"Y"===l.substring(0,1)&&(l=l.replace(/Y/,"1")),"Z"===l.substring(0,1)&&(l=l.replace(/Z/,"2")),t="TRWAGMYFPDXBNJZSQVHLCKE".charAt(+l.substring(0,8)%23),l.charAt(8)===t}return!!this.rules.additional[3].test(r)&&(t="TRWAGMYFPDXBNJZSQVHLCKE".charAt(+r.substring(1,8)%23),r.charAt(8)===t)},rules:{multipliers:[2,1,2,1,2,1,2],regex:[/^(ES)([A-Z]\d{8})$/,/^(ES)([A-HN-SW]\d{7}[A-J])$/,/^(ES)([0-9YZ]\d{7}[A-Z])$/,/^(ES)([KLMX]\d{7}[A-Z])$/],additional:[/^[A-H|J|U|V]\d{8}$/,/^[A-H|N-S|W]\d{7}[A-J]$/,/^[0-9|Y|Z]\d{7}[A-Z]$/,/^[K|L|M|X]\d{7}[A-Z]$/]}},a={name:"Sweden",codes:["SE","SWE","752"],calcFn:function(r){for(var e,t=0,n=0;n<9;n+=2)e=+r.charAt(n),t+=Math.floor(e/5)+2*e%10;for(var i=0,l=1;l<9;l+=2)i+=+r.charAt(l);return(10-(t+i)%10)%10===+r.slice(9,10)},rules:{regex:[/^(SE)(\d{10}01)$/]}},c={name:"United Kingdom",codes:["GB","GBR","826"],calcFn:function(r){var e,t=0;if("GD"===r.substr(0,2))return e=500,r.substr(2,3)<e;if("HA"===r.substr(0,2))return e=499,r.substr(2,3)>e;if(0==+r.slice(0))return!1;for(var n=+r.slice(0,7),i=0;i<7;i++)t+=+r.charAt(i)*this.rules.multipliers[i];for(var l=t;l>0;)l-=97;return(l=Math.abs(l))===+r.slice(7,9)&&n<9990001&&(n<1e5||n>999999)&&(n<9490001||n>97e5)||(l>=55?l-=55:l+=42,!!(l===(e=+r.slice(7,9))&&n>1e6))},rules:{multipliers:[8,7,6,5,4,3,2],regex:[/^(GB)?(\d{9})$/,/^(GB)?(\d{12})$/,/^(GB)?(GD\d{3})$/,/^(GB)?(HA\d{3})$/]}};function o(r,e,t){this.value=r||null,this.isValid=!!e,t&&(this.country={name:t.name,isoCode:{short:t.codes[0],long:t.codes[1],numeric:t.codes[2]}})}function d(r,e){return r===e[0]||r===e[1]||r===e[2]}function f(r,e){if(!r)return!1;for(var t=0;t<r.length;t++){var n=r[t].toUpperCase();if(n===e.name.toUpperCase())return!0;if(d(n,e.codes))return!0}return!1}function h(r,e){for(var t=0;t<e.length;t++){var n=e[t];if(n.test(r))return{isValid:!0,regex:n}}return{isValid:!1}}t.d(e,"jsvat",function(){return m});var m={blocked:[],allowed:[],countries:{austria:n,belgium:{name:"Belgium",codes:["BE","BEL","056"],calcFn:function(r){return 9===r.length&&(r="0"+r),0!=+r.slice(1,2)&&97-+r.slice(0,8)%97==+r.slice(8,10)},rules:{regex:[/^(BE)(0?\d{9})$/]}},bulgaria:{name:"Bulgaria",codes:["BG","BGR","100"],calcFn:function(r){function e(r,e,t,n,i){for(var l=t;l<n;l++)r+=+e.charAt(l)*(l+i);return r}function t(r,e,t,n,i){for(var l=t;l<n;l++)r+=+e.charAt(l)*i[l];return r}return 9===r.length?function(r){var t,n=0,i=+r.slice(8);return 10!=(t=(n=e(n,r,0,8,1))%11)?t===i:(10==(t=(n=e(0,r,0,8,3))%11)&&(t=0),t===i)}(r):function(r,e){if(/^\d\d[0-5]\d[0-3]\d\d{4}$/.test(r)){var n=+r.slice(2,4);if(n>0&&n<13||n>20&&n<33||n>40&&n<53){var i=t(0,r,0,9,e.multipliers.physical);if(10==(i%=11)&&(i=0),i===+r.substr(9,1))return!0}}return!1}(r,this.rules)||function(r,e){if(t(0,r,0,9,e.multipliers.foreigner)%10==+r.substr(9,1))return!0}(r,this.rules)||function(r,e){var n=t(0,r,0,9,e.multipliers.miscellaneous);return 10!=(n=11-n%11)&&(11===n&&(n=0),n===+r.substr(9,1))}(r,this.rules)},rules:{multipliers:{physical:[2,4,8,5,10,9,7,3,6],foreigner:[21,19,17,13,11,9,7,3,1],miscellaneous:[4,3,2,7,6,5,4,3,2]},regex:[/^(BG)(\d{9,10})$/]}},croatia:{name:"Croatia",codes:["HR","HRV","191"],calcFn:function(r){for(var e=10,t=0,n=0;n<10;n++)0==(t=(+r.charAt(n)+e)%10)&&(t=10),e=2*t%11;return(e+ +r.slice(10,11))%10==1},rules:{regex:[/^(HR)(\d{11})$/]}},cyprus:i,czech_republic:{name:"Czech Republic",codes:["CZ","CZE","203"],calcFn:function(r){return!!(function(r,e){var t=0;if(e.additional[0].test(r)){for(var n=0;n<7;n++)t+=+r.charAt(n)*e.multipliers[n];return 10==(t=11-t%11)&&(t=0),11===t&&(t=1),t===+r.slice(7,8)}return!1}(r,this.rules)||function(r,e){var t=0;if(e.additional[2].test(r)){for(var n=0;n<7;n++)t+=+r.charAt(n+1)*e.multipliers[n];10==(t=11-t%11)&&(t=0),11===t&&(t=1);var i=+r.slice(8,9);return e.lookup[t-1]===i}return!1}(r,this.rules)||function(r,e){return!!e.additional[3].test(r)&&!((+r.slice(0,2)+r.slice(2,4)+r.slice(4,6)+r.slice(6,8)+r.slice(8))%11!=0||+r%11!=0)}(r,this.rules)||function(r,e){if(e.additional[1].test(r))return!(+r.slice(0,2)>62)}(r,this.rules))},rules:{multipliers:[8,7,6,5,4,3,2],lookup:[8,7,6,5,4,3,2,1,0,9,10],regex:[/^(CZ)(\d{8,10})(\d{3})?$/],additional:[/^\d{8}$/,/^[0-5][0-9][0|1|5|6]\d[0-3]\d\d{3}$/,/^6\d{8}$/,/^\d{2}[0-3|5-8]\d[0-3]\d\d{4}$/]}},denmark:{name:"Denmark",codes:["DK","DNK","208"],calcFn:function(r){for(var e=0,t=0;t<8;t++)e+=+r.charAt(t)*this.rules.multipliers[t];return e%11==0},rules:{multipliers:[2,7,6,5,4,3,2,1],regex:[/^(DK)(\d{8})$/]}},estonia:{name:"Estonia",codes:["EE","EST","233"],calcFn:function(r){for(var e=0,t=0;t<8;t++)e+=+r.charAt(t)*this.rules.multipliers[t];return 10==(e=10-e%10)&&(e=0),e===+r.slice(8,9)},rules:{multipliers:[3,7,1,3,7,1,3,7],regex:[/^(EE)(10\d{7})$/]}},europe:{name:"Europe",codes:["EU","EUR","000"],calcFn:function(){return!0},rules:{regex:[/^(EU)(\d{9})$/]}},finland:{name:"Finland",codes:["FI","FIN","246"],calcFn:function(r){for(var e=0,t=0;t<7;t++)e+=+r.charAt(t)*this.rules.multipliers[t];return(e=11-e%11)>9&&(e=0),e===+r.slice(7,8)},rules:{multipliers:[7,9,10,5,8,4,2],regex:[/^(FI)(\d{8})$/]}},france:{name:"France",codes:["FR","FRA","250"],calcFn:function(r){return!/^\d{11}$/.test(r)||(100*+r.substring(2)+12)%97==+r.slice(0,2)},rules:{regex:[/^(FR)(\d{11})$/,/^(FR)([A-HJ-NP-Z]\d{10})$/,/^(FR)(\d[A-HJ-NP-Z]\d{9})$/,/^(FR)([A-HJ-NP-Z]{2}\d{9})$/]}},germany:{name:"Germany",codes:["DE","DEU","276"],calcFn:function(r){for(var e=10,t=0,n=0;n<8;n++)0==(t=(+r.charAt(n)+e)%10)&&(t=10),e=2*t%11;return(11-e==10?0:11-e)==+r.slice(8,9)},rules:{regex:[/^(DE)([1-9]\d{8})$/]}},greece:{name:"Greece",codes:["GR","GRC","300"],calcFn:function(r){var e=0;8===r.length&&(r="0"+r);for(var t=0;t<8;t++)e+=+r.charAt(t)*this.rules.multipliers[t];return(e%=11)>9&&(e=0),e===+r.slice(8,9)},rules:{multipliers:[256,128,64,32,16,8,4,2],regex:[/^(EL)(\d{9})$/]}},hungary:{name:"Hungary",codes:["HU","HUN","348"],calcFn:function(r){for(var e=0,t=0;t<7;t++)e+=+r.charAt(t)*this.rules.multipliers[t];return 10==(e=10-e%10)&&(e=0),e===+r.slice(7,8)},rules:{multipliers:[9,7,3,1,9,7,3],regex:[/^(HU)(\d{8})$/]}},ireland:l,italy:s,latvia:{name:"Latvia",codes:["LV","LVA","428"],calcFn:function(r){var e=0;if(/^[0-3]/.test(r))return!!/^[0-3][0-9][0-1][0-9]/.test(r);for(var t=0;t<10;t++)e+=+r.charAt(t)*this.rules.multipliers[t];return e%11==4&&9===r[0]&&(e-=45),e%11==4?e=4-e%11:e%11>4?e=14-e%11:e%11<4&&(e=3-e%11),e===+r.slice(10,11)},rules:{multipliers:[9,1,4,8,3,10,2,5,7,6],regex:[/^(LV)(\d{11})$/]}},lithuania:{name:"Lithuania",codes:["LT","LTU","440"],calcFn:function(r){function e(r,e,t){return+r.charAt(t)*e[t]}function t(r){return 10==(r%=11)&&(r=0),r}return function(r,n){var i=0;return 9===r.length&&!!/^\d{7}1/.test(r)&&(i=function(r,e){for(var t=0;t<8;t++)e+=+r.charAt(t)*(t+1);return e}(r,i),(i=t(i=function(r,t,n){if(t%11==10){t=0;for(var i=0;i<8;i++)t+=e(r,n.multipliers.short,i)}return t}(r,i,n)))===+r.slice(8,9))}(r,this.rules)||function(r,n){var i=0;return 12===r.length&&!!n.check.test(r)&&(i=t(i=function(r,t,n){if(t%11==10){t=0;for(var i=0;i<11;i++)t+=e(r,n.multipliers.alt,i)}return t}(r,i=function(r,t,n){for(var i=0;i<11;i++)t+=e(r,n.multipliers.med,i);return t}(r,i,n),n)))===+r.slice(11,12)}(r,this.rules)},rules:{multipliers:{short:[3,4,5,6,7,8,9,1],med:[1,2,3,4,5,6,7,8,9,1,2],alt:[3,4,5,6,7,8,9,1,2,3,4]},check:/^\d{10}1/,regex:[/^(LT)(\d{9}|\d{12})$/]}},luxembourg:{name:"Luxembourg",codes:["LU","LUX","442"],calcFn:function(r){var e=+r.slice(6,8);return+r.slice(0,6)%89===e},rules:{regex:[/^(LU)(\d{8})$/]}},malta:{name:"Malta",codes:["MT","MLT","470"],calcFn:function(r){for(var e=0,t=0;t<6;t++)e+=+r.charAt(t)*this.rules.multipliers[t];return(e=37-e%37)==+r.slice(6,8)},rules:{multipliers:[3,4,6,7,8,9],regex:[/^(MT)([1-9]\d{7})$/]}},netherlands:{name:"Netherlands",codes:["NL","NLD","528"],calcFn:function(r){for(var e=0,t=0;t<8;t++)e+=+r.charAt(t)*this.rules.multipliers[t];return(e%=11)>9&&(e=0),e===+r.slice(8,9)},rules:{multipliers:[9,8,7,6,5,4,3,2],regex:[/^(NL)(\d{9})B\d{2}$/]}},norway:{name:"Norway",codes:["NO","NOR","578"],calcFn:function(r){for(var e=0,t=0;t<8;t++)e+=+r.charAt(t)*this.rules.multipliers[t];if(11==(e=11-e%11)&&(e=0),e<10)return e===+r.slice(8,9)},rules:{multipliers:[3,2,7,6,5,4,3,2],regex:[/^(NO)(\d{9})$/]}},poland:{name:"Poland",codes:["PL","POL","616"],calcFn:function(r){for(var e=0,t=0;t<9;t++)e+=+r.charAt(t)*this.rules.multipliers[t];return(e%=11)>9&&(e=0),e===+r.slice(9,10)},rules:{multipliers:[6,5,7,2,3,4,5,6,7],regex:[/^(PL)(\d{10})$/]}},portugal:{name:"Portugal",codes:["PT","PRT","620"],calcFn:function(r){for(var e=0,t=0;t<8;t++)e+=+r.charAt(t)*this.rules.multipliers[t];return(e=11-e%11)>9&&(e=0),e===+r.slice(8,9)},rules:{multipliers:[9,8,7,6,5,4,3,2],regex:[/^(PT)(\d{9})$/]}},romania:{name:"Romania",codes:["RO","ROU","642"],calcFn:function(r){for(var e=0,t=r.length,n=this.rules.multipliers.slice(10-t),i=0;i<r.length-1;i++)e+=+r.charAt(i)*n[i];return 10==(e=10*e%11)&&(e=0),e===+r.slice(r.length-1,r.length)},rules:{multipliers:[7,5,3,2,1,7,5,3,2],regex:[/^(RO)([1-9]\d{1,9})$/]}},russia:{name:"Russian Federation",codes:["RU","RUS","643"],calcFn:function(r){return function(r,e){var t=0;if(10===r.length){for(var n=0;n<10;n++)t+=+r.charAt(n)*e.multipliers.m_1[n];return(t%=11)>9&&(t%=10),t===+r.slice(9,10)}return!1}(r,this.rules)||function(r,e){var t=0,n=0;if(12===r.length){for(var i=0;i<11;i++)t+=+r.charAt(i)*e.multipliers.m_2[i];(t%=11)>9&&(t%=10);for(var l=0;l<11;l++)n+=+r.charAt(l)*e.multipliers.m_3[l];(n%=11)>9&&(n%=10);var s=t===+r.slice(10,11),u=n===+r.slice(11,12);return s&&u}return!1}(r,this.rules)},rules:{multipliers:{m_1:[2,4,10,3,5,9,4,6,8,0],m_2:[7,2,4,10,3,5,9,4,6,8,0],m_3:[3,7,2,4,10,3,5,9,4,6,8,0]},regex:[/^(RU)(\d{10}|\d{12})$/]}},serbia:{name:"Serbia",codes:["RS","SRB","688"],calcFn:function(r){for(var e=10,t=0,n=0;n<8;n++)0==(t=(+r.charAt(n)+e)%10)&&(t=10),e=2*t%11;return 1==(e+ +r.slice(8,9))%10},rules:{regex:[/^(RS)(\d{9})$/]}},slovakia_republic:{name:"Slovakia_Republic",codes:["SK","SVK","703"],calcFn:function(r){return 0==r%11},rules:{regex:[/^(SK)([1-9]\d[2346-9]\d{7})$/]}},slovenia:{name:"Slovenia",codes:["SI","SVN","705"],calcFn:function(r){for(var e,t=0,n=0;n<7;n++)t+=+r.charAt(n)*this.rules.multipliers[n];return 10==(t=11-t%11)&&(t=0),e=+r.slice(7,8),!(11===t||t!==e)},rules:{multipliers:[8,7,6,5,4,3,2],regex:[/^(SI)([1-9]\d{7})$/]}},spain:u,sweden:a,switzerland:{name:"Switzerland",codes:["CH","CHE","756"],calcFn:function(r){for(var e=0,t=0;t<8;t++)e+=+r.charAt(t)*this.rules.multipliers[t];return 10!=(e=11-e%11)&&(11===e&&(e=0),e===+r.substr(8,1))},rules:{multipliers:[5,4,3,2,7,6,5,4],regex:[/^(CHE)(\d{9})(MWST)?$/]}},united_kingdom:c},checkVAT:function(r){if(!r)throw new Error("VAT should be specified");var e=function(r){return(r=r||"").toString().toUpperCase().replace(/(\s|-|\.)+/g,"")}(r),t=new o(e),n=function(r,e){for(var t in e)if(e.hasOwnProperty(t)&&h(r,e[t].rules.regex).isValid)return e[t];return null}(e,this.countries);if(!n)return t;if(function(r,e,t){if(f(e,r))return!0;var n=f(t,r);return t.length>0&&!n}(n,this.blocked,this.allowed))return new o(e,!1,n);var i=function(r,e){var t=h(r,e.rules.regex);return!!t.isValid&&function(r,e){return e.calcFn(r)}(t.regex.exec(r)[2],e)}(e,n);return i?new o(e,i,n):t}}}])});
//# sourceMappingURL=jsvat.js.map